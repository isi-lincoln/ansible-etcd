- hosts: [a,b,c,x]
  become: true
  vars:
    a: 10.0.0.1
    b: 10.0.0.2
    c: 10.0.0.3
    x: 10.0.0.10
  tasks:

    - blockinfile:
        path: /etc/network/interfaces
        block: |
          auto eth1
          iface eth1 inet static
            address {{vars[inventory_hostname_short]}}/24

    - blockinfile:
        path: /etc/hosts
        block: |
          10.0.0.1 dba
          10.0.0.2 dbb
          10.0.0.3 dbc
          10.0.0.10 xc

    - shell: ifup eth1

- hosts: s
  become: true
  tasks:

    - nclu:
        commands:
          - add int swp1
          - add int swp2
          - add int swp3
          - add int swp4
          - add bridge bridge ports swp1-4
        atomic: true
